# 产品需求文档 (PRD)

## Agent MVP v1.0：科研基金申请智能助理（高能动性系统）

### I. 战略、目标与能动性（Strategy & Agency Focus）

#### 1. 产品愿景与核心能动性
Agent 作为一个**独立自主的对象**，旨在实现**科研申请流程的“自动化大使”**。 Agent 必须体现出**自主、可靠、战略性的行动能力**，通过提供**预实验建议**和**可行性增强方案**，尽可能减少 ECR 的撰写难度，并将 ECR 的**初步想法**转化为**符合评审偏好的结构化提案** [Previous Discussion]。

#### 2. 目标用户与成功衡量指标 (Validation Metric)
*   **目标用户：** 职业早期科研研究者 (ECR)。
*   **核心目标：** **提升标书质量（获批率）**，并将**能动性**（即系统提供的深度指导和战略价值）作为关键衡量指标 [Previous Discussion]。

### II. 核心功能集： Agent 三大高能动性服务模块

#### A. 知识与趋势分析服务 (K-TAS): 战略分析的能动性
K-TAS 负责将研究主题定位在最具资助潜力的战略框架内，并为后续的**可行性建议**提供数据基础。

| 功能点 | 核心能动性体现 | RDR/AI 实现机制 |
| :--- | :--- | :--- |
| **研究趋势对齐** | ECR 只输入主题，Agent 自动定位课题的**新兴趋势**和**高影响力方向** [Previous Discussion]，指导“立项依据”的战略定位。 | 基于 RDR 的**嵌入分析**和**聚类**，识别正在**加速发展的领域** [Previous Discussion, 2]。 |
| **证据驱动的文献检索** | 自动检索和验证**最新、高社区影响力**的文献（例如 **LLM Agents**、**Dense Retrieval & RAG**）作为**立项依据**的证据支持。 | 使用 **DeepSeek R1** 进行**语义检索**和**影响力定位**，返回紧密贴合主题的论文并提供引用次数。 |
| **课题视角定义与映射** | Agent **自主定义**并展示研究格局的结构。 | 利用 DeepSeek R1 对论文内容进行**视角提取**，根据预设视角（例如：建模、控制与规划、评估等）来映射论文位置，为可行性分析提供结构化参考。 |

#### B. 结构化提案生成与指导服务 (SPG-S): 内容创作及建议的能动性
SPG-S 是内容引擎，并新增了**预测性指导**功能，旨在减少 ECR 撰写“研究方案”、“可行性”和“工作基础”部分的难度。

| 功能模块 | NSFC 对应项 | Agent 的高能动性指导与逻辑 | 来源支撑/机制 |
| :--- | :--- | :--- | :--- |
| **项目可行性与预实验指导** (新增能动性) | **可行性分析**、**工作基础** | **预实验建议：** Agent 根据 ECR 的想法，建议开展**低成本、快速的实验（MVP）**来验证**最关键的科学或技术假设（信仰飞跃假设）**。这有助于增强“工作基础”和“可行性”。 | Agent 必须能够自主识别项目的**风险最大的假设**。 |
| **可行性增强内容建议** (新增能动性) | **研究内容、方案** | Agent 结合 RDR 的**课题视角**分析，提示 ECR 在研究方案中**添加关键内容**。例如，若课题涉及多智能体， Agent 建议加入**多智能体协作或 Planner-Actor-Corrector-Verifier 循环**，以提升项目的**技术完备性**和**可行性**。 | DeepSeek R1 整合 RDR 知识图谱中与课题相关的**高级技术（如 Multi-agent loops, RLHF alignment）**。 |
| **结构化综述自动化** | 立项依据 | Agent **自主将 RDR 分析结果**转化为连贯、高质量的“立项依据”文本，并确保内容中对背景的描述**不超过总篇幅的 30%—40%**。 | 利用 DeepSeek R1 和 RDR 的**知识投影**技术。 |
| **逻辑关联强化** | 目标、内容、方案 | 确保目标、内容、方案之间形成**由简到繁的逻辑关联**（塔形结构）。 | DeepSeek R1 确保总目标分解为**约 3个子目标**。 |

#### C. 文档设计与合规服务 (DDC-S): 规范性与阅读体验的能动性
**目标：** 严格遵循 NSFC/BIT 规范，并利用 UX 设计原则（如 CRAP）优化评审人阅读体验。

| 格式要素 | 规范要求（Agent 自动化执行） | 设计原则与 UX 目标 |
| :--- | :--- | :--- |
| **字体、字号与间距** | 正文：**宋体小四号**（英文 Times New Roman 12磅），行距 **22磅** [Previous Discussion]。 | 通过**对比**（Contrast）原则，利用粗黑标题与正文的对比，使读者**快速抓住要点**。 |
| **结构透明化** | 确保标题与其**相关段落靠近**（亲密性，Proximity），避免标题与它上下的正文之间有相同的距离。 | **亲密性**原则：将相关的项组织成**视觉单元**，减少混乱。 |
| **排版对齐** | 正文**两端对齐**，所有节标题**顶左**（左对齐）。Agent 必须避免在页面上存在两种对齐方式（如居中和左对齐混用）。 | **对齐（Alignment）**原则：制造**精巧且统一**的外观。 |
| **参考文献合规性** | 参考文献内容：**宋体五号**（英文 Times New Roman **10.5磅**）。检查引用文献是否**陈旧**（应引用最新的）。 | 参考文献格式需严格遵守 GB/T 7714—2005 规范。 |

### IV. 技术规格与系统设计 (Technical Specifications)

#### 1. 技术栈选型与 LLM 映射
*   **DBMS：** PostgreSQL (默认模型 Process per DBMS Worker) [User Query, 39]。
*   **并发控制：** **MVCC (多版本并发控制)** [User Query, 172]。
*   **Agent 知识共享：** **共享内存 (Shared-Memory)** 架构，利用 Buffer Pool 等共享数据结构缓存 RDR 分析结果，实现系统级别的**协作和学习** [User Query, 25, 32]。
*   **LLM 模型：** **DeepSeek V3.2**（用于 Area Filtering 等简单任务）和 **DeepSeek R1**（用于 SPG-S 的推理密集型任务，如**结构化综述生成**和**可行性建议**）[User Query, 321, 2]。
*   **语义索引：** **内置 PostgreSQL 索引**（如 GiST/R-tree）[User Query, 113, 132]，简化早期架构，存储 RDR 嵌入表示。

#### 2. 关键工程策略：能动性的性能保障

##### A. 执行准入控制 (Execution Admission Controller)
*   **策略：** **基于内存占用**进行准入控制 [User Query, 45, 46]。
*   **原因：** RDR 分析中的**聚类、排序**等操作是内存密集型的，该策略能防止系统进入**颠簸 (thrash)** 状态，保障 Agent 的可靠性 [User Query, 45]。

##### B. 内存分配机制：上下文内存分配器 (Memory Contexts)
*   **策略：** 采用**上下文内存分配器 (Context-Based Allocator)** [User Query, 220]。为 Agent 的每个**查询/标书生成会话**（例如 K-TAS 分析阶段或 SPG-S 生成阶段）分配一个或多个**内存上下文** [User Query]。
*   **优势：** 这机制提高了代码的**可维护性**和**安全性**，防止内存泄漏，是复杂、多阶段 RDR 计算流程的理想选择。

#### 3. 数据安全与保密性
*   Agent 的所有复杂计算和 RDR 分析都将在**服务器端**进行，以保护核心的模型权重和数据结构 [Previous Discussion]。
*   采用 **MVCC** 确保不同用户的标书数据在逻辑上和物理上**完全隔离** [172, Previous Discussion]。
*   **关系查询处理器**必须检查用户是否被**授权访问**其标书数据，以作为安全的关键防线。

### VI. 科学知识库范围（RDR Data）

RDR Agent 的知识库必须持续更新并覆盖 NSFC 的核心领域，以支撑 K-TAS 的深度分析和 SPG-S 的**专业建议能动性**。

*   **RDR 深度分析：** 涵盖信息科学（LLM Agents、Dense Retrieval/RAG）、工程与材料科学/机器人学（远程操作、灵巧操作）以及自然科学等领域。
*   **数据结构：** 知识库内容必须通过**视角提取** 和**内容投影** 进行结构化，以便 Agent 能识别并建议 ECR 弥补其研究方案中的技术或理论空白。